{% extends 'base.html' %}
{% load crispy_forms_filters %}
    {% block content %}
        <div class="container mt-4">
            <form method="post">
                {% csrf_token %}
                <div class="form-group">
                    {{form|crispy}}
                </div>
                
                <div class="card mt-4 mb-4 border-secondary">
                    <div class="card-header">Output: </div>
                    <div id="target" class="card-body"></div>
                </div>

                <div class="form-group">
                    <button class="btn btn-block btn-outline-primary" type="submit">
                        Create question
                    </button>
                </div>
            </form>
        </div>
        

        <!-- Showdown JS Config -->
        <script src="https://unpkg.com/showdown/dist/showdown.min.js"></script>
        <script defer>
            const converter = new showdown.Converter()
            const description_box = document.getElementById('id_description')
            const target = document.getElementById('target')
            const defaultText = "<span class=\"text-muted\">Start typing to see the output!</span>"

            const updateOutput = () => {
                const text = description_box.value
                if(text.trim() === ''){
                    target.innerHTML = defaultText
                    return null
                }
                html = converter.makeHtml(text)
                target.innerHTML = html
            }
            
            description_box.addEventListener('input', updateOutput)
            updateOutput()
        </script>

    {% endblock content %}